# -*- coding: utf-8 -*-
"""Untitled4.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1IwTb3XkL8ynyrWiTw3hN5xadi0xq7F1A

[source](https://www.w3schools.com/python/python_mysql_getstarted.asp)
"""

import mysql.connector


class db_connector:
    def __init__(self):
        mydb = mysql.connector.connect(
            host="localhost",
            user="root",
            password="MYSQL1378"  
        )
        mycursor = mydb.cursor()
        mycursor.execute("SHOW DATABASES")

        #databases = [x[0] for x in mycursor] ??
        if "SADProject" not in databases:
            mycursor.execute("CREATE DATABASE SADProject")
            mydb = mysql.connector.connect(
                host="localhost",
                user="root",
                password="MYSQL1378",
                database="SADProject"
                )
            mycursor.execute("CREATE TABLE customer (customerID VARCHAR(255) PRIMARY KEY, email VARCHAR(255) NOT NULL)")
            mycursor.execute("CREATE TABLE product_order (productID VARCHAR(255) PRIMARY KEY, unit_price INTEGER NOT NULL, productID VARCHAR(255) NOT NULL)")
            mycursor.execute("CREATE TABLE customer_order (customer_orderID VARCHAR(255) PRIMARY KEY, customerID VARCHAR(255) NOT NULL, product_orderID VARCHAR(255) NOT NULL, FOREIGN KEY (customerID) REFERENCES customer (customerID), FOREIGN KEY (product_orderID) REFERENCES product_order (product_orderID))")
        else:
            mydb = mysql.connector.connect(
                host="localhost",
                user="root",
                password="MYSQL1378",
                database="SADProject"
                )
        slef.mydb = mydb

    def insert_customer(self, id, email):

        sql = "INSERT INTO customer (customerID, email) VALUES (%s, %s)"
        val = (id, email)
        mycursor.execute(sql, val)

        mydb.commit()

    def insert_product_order(self, product_order_id, price, product_id):

        sql = "INSERT INTO product_order (productID, unit_price, productID) VALUES (%s, %s, %s)"
        val = (product_order_id, price, product_id)
        mycursor.execute(sql, val)

        mydb.commit()

    def insert_customer_order(self, customer_order_id, customer_id, product_order_id):
        sql = "INSERT INTO customer_order (customer_orderID, customerID, product_orderID) VALUES (%s, %s, %s)"
        val = (product_order_id, price, product_id)
        mycursor.execute(sql, val)

        mydb.commit()

if __name__ == "__main__":
    connector = db_connector()